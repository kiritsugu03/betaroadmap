<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<title>Roadmap</title>
	<meta name="viewport" content="initial-scale=1.0">
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">

	<style type="text/css">
	/*custom CSS here*/
	.navbar-text
	{
		margin-left: 0px;
	}
	body 
	{ 
		padding-top: 70px; 
	}
	.panel-body
	{
		height: 400px;
	}
	.panel-heading
	{
		text-align: center;
	}
	#toolPics
	{
		height: 200px;
		width: 200px;
	}
	.content
	{
		font-family: Arial;
		font-size: 15px;
		font-weight: bold;
	}
	</style>
</head>


<body id="bod">
	<nav class="navbar navbar-default navbar-fixed-top">
		<div class="container">
				<span><h3 class="navbar-text">Roadmap</h3></span>
			<form class="navbar-form navbar-right" role="search">
				  <div class="form-group">
				    <input type="text" class="form-control" placeholder="Search">
				  </div>
				  <button type="button" class="btn btn-default btn-md">
					  <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
				</button>
			</form>
		</div>
	</nav>

	<div class="container">
		  <div class="row">
				<div class="col-lg-9">
					<div class="panel panel-body" id="mapContainer">
						<script type="text/javascript">

					   	
					    </script>
					</div>
				</div>
				<div class="col-lg-3">
					<div class="thumbnail">
				      <img id="toolPics" src="Google-Maps-icon.png" alt="...">
				      <div class="caption">
				        <h4>Google Maps</h4>
				        <p>Provides directions, interactive maps, and satellite/aerial imagery of many countries. Can also search by keyword such as type of business.</p>
				        <p><a href="#" class="btn btn-primary" role="button">Learn more</a></p>
				      </div>
				    </div>
				</div>
		</div>
	</div>
	<div class="container">
	  <table class="table">
	   <thead>
	    <tr>
	     <th>oid</th>
	     <th>site name</th>
	     <th>site id</th>
	     <th>operator</th>
	     <th>software release</th>
	     <th>technology</th>
	     <th>site type</th>
	     <th>controller id</th>
	     <th>operating bands</th>
	     <th>site layouts</th>
	    </tr>
	   </thead>
	   <tbody id="tableBody">
	   </tbody>
	  </table>
 	</div>
 	<script>
	function loadTable() {
	    var data = {
	        Site1: {
	            oid: "5580494844ef0e3b4caa1885",
	            site_name : "G2860QCNVMGMR1",
	            site_id : "BCF-60",
	            operator : "Smart (Philippines)",
	            software_release : "S15",
	            technology : "GSM",
	            site_type : "Flexi Multiradio",
	            controller_id : "BSC-388789",
	            operating_bands : "1800",
	            site_layouts : "3"
	        },
	        Site2: {
	            oid: "5580494844ef0e3b4caa1885",
	            site_name : "108ZZZBARTGFE1",
	            site_id : "BCF-39",
	            operator : "Smart (Philippines)",
	            software_release : "S15",
	            technology : "GSM",
	            site_type : "Flexi EDGE",
	            controller_id : "BSC-388789",
	            operating_bands : "1800",
	            site_layouts : "3"
	        },
	        Site3: {
	            oid: "5580494844ef0e3b4caa1885",
	            site_name : "P25ZZSMTPQGMR1",
	            site_id : "BCF-17",
	            operator : "Smart (Philippines)",
	            software_release : "S15",
	            technology : "GSM",
	            site_type : "Flexi Multiradio",
	            controller_id : "BSC-239095",
	            operating_bands : "900",
	            site_layouts : "4+4+4"
	        },
	        Site4: {
	            oid: "5580494844ef0e3b4caa1885",
	            site_name : "211ZZFLVS1GMR1",
	            site_id : "BCF-17",
	            operator : "Smart (Philippines)",
	            software_release : "S15",
	            technology : "GSM",
	            site_type : "Flexi Multiradio",
	            controller_id : "BSC-238616",
	            operating_bands : "900",
	            site_layouts : "4+4+4"
	        },
	        Site5: {
	            oid: "5580494844ef0e3b4caa1885",
	            site_name : "E91ZZROBFVGMR1",
	            site_id : "BCF-57",
	            operator : "Smart (Philippines)",
	            software_release : "S15",
	            technology : "GSM",
	            site_type : "Flexi Multiradio",
	            controller_id : "BSC-238616",
	            operating_bands : "1800",
	            site_layouts : "3"
	        }
	    }

	    var tableBody = document.getElementById("tableBody");
	    var tr = document.createElement("tr");
	    var td = document.createElement("td");
	    
	    for (var siteData in data) {
	        var tr = document.createElement("tr");
	        var td1 = document.createElement("td");
	        td1.appendChild(document.createTextNode(data[siteData].oid));
	        tr.appendChild(td1);
	        var td2 = document.createElement("td");
	        td2.appendChild(document.createTextNode(data[siteData].site_name));
	        tr.appendChild(td2);
	        var td3 = document.createElement("td");
	        td3.appendChild(document.createTextNode(data[siteData].site_id));
	        tr.appendChild(td3);
	        var td4 = document.createElement("td");
	        td4.appendChild(document.createTextNode(data[siteData].operator));
	        tr.appendChild(td4);
	        var td5 = document.createElement("td");
	        td5.appendChild(document.createTextNode(data[siteData].software_release));
	        tr.appendChild(td5);
	        var td6 = document.createElement("td");
	        td6.appendChild(document.createTextNode(data[siteData].technology));
	        tr.appendChild(td6);
	        var td7 = document.createElement("td");
	        td7.appendChild(document.createTextNode(data[siteData].site_type));
	        tr.appendChild(td7);
	        var td8 = document.createElement("td");
	        td8.appendChild(document.createTextNode(data[siteData].controller_id));
	        tr.appendChild(td8);
	        var td9 = document.createElement("td");
	        td9.appendChild(document.createTextNode(data[siteData].operating_bands));
	        tr.appendChild(td9);
	        var td10 = document.createElement("td");
	        td10.appendChild(document.createTextNode(data[siteData].site_layouts));
	        tr.appendChild(td10);
	        tableBody.appendChild(tr);
	    }
	}
 	</script>
 	<script>loadTable();</script>
	<footer id="footer">
		<div class="container">
			<hr>
			<p><small><a href="#">Like me</a> On facebook</small></p>
			<p>	<small><a href="#">Ask whatever</a> On Twitter</small></p>
			<p>	<small><a href="#">Subscribe me</a> On Youtube</small></p>
		</div> <!-- end container -->
	</footer> 
		
	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maps.googleapis.com/maps/api/js?callback=initMap"
        async defer></script>
	<script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
	<script src="js/markerclusterer_compiled.js"></script>		
	<script>
	var sitemap;
			function componentToHex(c) {
			    var hex = c.toString(16);
			    return hex.length == 1 ? "0" + hex : hex;
			}

			function rgbToHex(r, g, b) {
			    return "#" + componentToHex(r) + componentToHex(g) + componentToHex(b);
			}
	    	var map;
				function initMap() {
					
			    $.ajax({
					type: "GET",
					url: 'http://localhost:8080/api/sites',
					dataType: 'json',
			        success: function(data) {
			            //$("#bod").append(data);
			        	console.log(data);
				    	sitemap = data;
				    	setPoints();
			        },
			        error: function(jqXHR, textStatus, errorThrown) {
			            alert('error ' + textStatus + " " + errorThrown);
			        }
				});
				  var myLatLng = {lat: 14.655663, lng: 121.0607978};
				  var bounds = new google.maps.LatLngBounds();

					  map = new google.maps.Map(document.getElementById('mapContainer'), {
					    zoom: 10,
					    center: myLatLng
					  });
					  
				  function setPoints(){
					var markers = [];
				  	for (var site in sitemap) {

			        console.log(sitemap[site]);
				  	/*var r = Math.round(Math.random()*255);
		            var g = Math.round(Math.random()*255);
		            var b = Math.round(Math.random()*255);*/
				   // Add the circle for this city to the map.
					   var cityCircle = new google.maps.Circle({
					     strokeColor: '#00FF00',
					     strokeOpacity: 0.8,
					     strokeWeight: 2,
					     fillColor: '#00FF00',
					     fillOpacity: 0.35,
					     map: map,
					     center: {lat: sitemap[site].position.latitude, lng: sitemap[site].position.longitude},
					     radius: Math.sqrt(sitemap[site].population) * 100,
					     visible: true
					   });

					   var marker = new google.maps.Marker({
					    position: {lat: sitemap[site].position.latitude, lng: sitemap[site].position.longitude},
					    title: 'Site Name: '+ sitemap[site].site_name,
						content: 'Site Operator: ' + sitemap[site].operator + '<br/>' + 'Site Type: ' +
								sitemap[site].site_type + '<br/>' + 'Technology: ' + sitemap[site].technology,
					    icon: "https://www.google.com/support/enterprise/static/geo/cdate/art/dots/blue_dot.png"
					   });
					   	
					   bounds.extend(marker.position);
						
					   google.maps.event.addListener(marker, 'click', (function(marker, i) {
						    return function() {
						      	map.setZoom(16);
					    		map.setCenter(marker.getPosition());
					    
					    		var contentString = marker.title + '<br/>' + marker.content;
				  				var infowindow = new google.maps.InfoWindow({
										    content: contentString
										  });
				  				infowindow.open(map, marker);
						    }
						  })(marker, site));
					   //marker.setMap(map);
					   markers.push(marker);
				    }
					var mcOptions = {gridSize: 50, maxZoom: 15};
					var markerCluster = new MarkerClusterer(map, markers, mcOptions);
				  }
				 			  
				}
	</script>
</body>	
</html>